VERSION 5.00
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.Form frmGlobals 
   Caption         =   "Edit Inputs Applying to All Segments"
   ClientHeight    =   9540
   ClientLeft      =   60
   ClientTop       =   345
   ClientWidth     =   6120
   BeginProperty Font 
      Name            =   "Microsoft Sans Serif"
      Size            =   9.75
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   HelpContextID   =   2
   LinkTopic       =   "Form1"
   ScaleHeight     =   9540
   ScaleWidth      =   6120
   StartUpPosition =   3  'Windows Default
   Begin VB.TextBox txtGlobal 
      Height          =   1695
      Index           =   18
      Left            =   840
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertical
      TabIndex        =   18
      Text            =   "frmGlobals.frx":0000
      Top             =   2040
      Width           =   4815
   End
   Begin VB.TextBox txtGlobal 
      Height          =   375
      Index           =   17
      Left            =   840
      TabIndex        =   17
      Text            =   "Text1"
      Top             =   1560
      Width           =   4815
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   16
      Left            =   4560
      TabIndex        =   16
      Text            =   "Text1"
      Top             =   8760
      Width           =   1000
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   15
      Left            =   2880
      TabIndex        =   15
      Text            =   "Text1"
      Top             =   8760
      Width           =   1575
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   14
      Left            =   4560
      TabIndex        =   14
      Text            =   "Text1"
      Top             =   8280
      Width           =   1000
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   13
      Left            =   2880
      TabIndex        =   13
      Text            =   "Text1"
      Top             =   8280
      Width           =   1575
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   12
      Left            =   4560
      TabIndex        =   12
      Text            =   "Text1"
      Top             =   7800
      Width           =   1000
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   11
      Left            =   2880
      TabIndex        =   11
      Text            =   "Text1"
      Top             =   7800
      Width           =   1575
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   10
      Left            =   4560
      TabIndex        =   10
      Text            =   "Text1"
      Top             =   7320
      Width           =   1000
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   9
      Left            =   2880
      TabIndex        =   9
      Text            =   "Text1"
      Top             =   7320
      Width           =   1575
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   8
      Left            =   4560
      TabIndex        =   8
      Text            =   "Text1"
      Top             =   6840
      Width           =   1000
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   7
      Left            =   2880
      TabIndex        =   7
      Text            =   "Text1"
      Top             =   6840
      Width           =   1575
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   6
      Left            =   4560
      TabIndex        =   6
      Text            =   "Text1"
      Top             =   5760
      Width           =   1000
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   5
      Left            =   2880
      TabIndex        =   5
      Text            =   "Text1"
      Top             =   5760
      Width           =   1575
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   4
      Left            =   4560
      TabIndex        =   4
      Text            =   "Text1"
      Top             =   5280
      Width           =   1000
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   3
      Left            =   2880
      TabIndex        =   3
      Text            =   "Text1"
      Top             =   5280
      Width           =   1575
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   2
      Left            =   4560
      TabIndex        =   2
      Text            =   "Text1"
      Top             =   4800
      Width           =   1000
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   1
      Left            =   2880
      TabIndex        =   1
      Text            =   "Text1"
      Top             =   4800
      Width           =   1575
   End
   Begin VB.TextBox txtGlobal 
      Alignment       =   2  'Center
      Height          =   375
      Index           =   0
      Left            =   2880
      TabIndex        =   0
      Text            =   "Text1"
      Top             =   4320
      Width           =   1575
   End
   Begin MSComctlLib.Toolbar Toolbar1 
      Align           =   1  'Align Top
      Height          =   630
      Left            =   0
      TabIndex        =   33
      Top             =   0
      Width           =   6120
      _ExtentX        =   10795
      _ExtentY        =   1111
      ButtonWidth     =   1032
      ButtonHeight    =   953
      Appearance      =   1
      HelpContextID   =   2
      _Version        =   393216
      BeginProperty Buttons {66833FE8-8583-11D1-B16A-00C0F0283628} 
         NumButtons      =   5
         BeginProperty Button1 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Caption         =   "Clear"
            Key             =   "bthClear"
            Object.ToolTipText     =   "Clear all values"
         EndProperty
         BeginProperty Button2 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Caption         =   "Undo"
            Key             =   "btnUndo"
            Object.ToolTipText     =   "Restore initial values"
         EndProperty
         BeginProperty Button3 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Caption         =   "Help"
            Key             =   "btnHelp"
            Object.ToolTipText     =   "Get Help"
         EndProperty
         BeginProperty Button4 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Caption         =   "Cancel"
            Key             =   "btnCancel"
            Object.ToolTipText     =   "Return to menu without saving edits"
         EndProperty
         BeginProperty Button5 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Caption         =   "OK"
            Key             =   "btnOK"
            Object.ToolTipText     =   "Save edits & return to menu"
         EndProperty
      EndProperty
      BorderStyle     =   1
   End
   Begin VB.Label lblLabel 
      Alignment       =   1  'Right Justify
      Caption         =   "Notes:"
      Height          =   375
      Index           =   13
      Left            =   -240
      TabIndex        =   34
      Top             =   2160
      Width           =   975
   End
   Begin VB.Label lblLabel 
      Alignment       =   1  'Right Justify
      Caption         =   "Title:"
      Height          =   375
      Index           =   12
      Left            =   -840
      TabIndex        =   32
      Top             =   1560
      Width           =   1575
   End
   Begin VB.Label lblDefinitions 
      Alignment       =   2  'Center
      Caption         =   "Label1"
      ForeColor       =   &H8000000D&
      Height          =   375
      Left            =   360
      TabIndex        =   31
      Top             =   960
      Width           =   5175
   End
   Begin VB.Label lblLabel 
      Alignment       =   2  'Center
      Caption         =   "CV"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   11
      Left            =   4440
      TabIndex        =   30
      Top             =   3960
      Width           =   975
   End
   Begin VB.Label lblLabel 
      Alignment       =   2  'Center
      Caption         =   "Mean"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   10
      Left            =   3120
      TabIndex        =   29
      Top             =   3960
      Width           =   975
   End
   Begin VB.Label lblLabel 
      Alignment       =   2  'Center
      Caption         =   "Atmospheric Loads (mg/m2-yr)"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   9
      Left            =   2520
      TabIndex        =   28
      Top             =   6240
      Width           =   3255
   End
   Begin VB.Label lblLabel 
      Alignment       =   1  'Right Justify
      Caption         =   "Conservative Substance:"
      Height          =   375
      Index           =   8
      Left            =   0
      TabIndex        =   27
      Top             =   8760
      Width           =   2655
   End
   Begin VB.Label lblLabel 
      Alignment       =   1  'Right Justify
      Caption         =   "Evap (m)/Avr Period:"
      Height          =   375
      Index           =   7
      Left            =   0
      TabIndex        =   26
      Top             =   5280
      Width           =   2775
   End
   Begin VB.Label lblLabel 
      Alignment       =   1  'Right Justify
      Caption         =   "Inorganic N:"
      Height          =   375
      Index           =   6
      Left            =   480
      TabIndex        =   25
      Top             =   8280
      Width           =   2175
   End
   Begin VB.Label lblLabel 
      Alignment       =   1  'Right Justify
      Caption         =   "Total N:"
      Height          =   375
      Index           =   5
      Left            =   480
      TabIndex        =   24
      Top             =   7800
      Width           =   2175
   End
   Begin VB.Label lblLabel 
      Alignment       =   1  'Right Justify
      Caption         =   "Ortho P:"
      Height          =   375
      Index           =   4
      Left            =   480
      TabIndex        =   23
      Top             =   7320
      Width           =   2175
   End
   Begin VB.Label lblLabel 
      Alignment       =   1  'Right Justify
      Caption         =   "Total P:"
      Height          =   375
      Index           =   3
      Left            =   480
      TabIndex        =   22
      Top             =   6840
      Width           =   2175
   End
   Begin VB.Label lblLabel 
      Alignment       =   1  'Right Justify
      Caption         =   "Storage Gain (m)/ Avr Period:"
      Height          =   375
      Index           =   2
      Left            =   0
      TabIndex        =   21
      Top             =   5760
      Width           =   2775
   End
   Begin VB.Label lblLabel 
      Alignment       =   1  'Right Justify
      Caption         =   "Precip. (m)/Avr Period:"
      Height          =   375
      Index           =   1
      Left            =   0
      TabIndex        =   20
      Top             =   4800
      Width           =   2775
   End
   Begin VB.Label lblLabel 
      Alignment       =   1  'Right Justify
      Caption         =   "Averaging Period (yrs):"
      Height          =   375
      Index           =   0
      Left            =   0
      TabIndex        =   19
      Top             =   4320
      Width           =   2775
   End
End
Attribute VB_Name = "frmGlobals"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Const nboX As Integer = 18

Dim glAvrPeriod As Single
Private Sub Toolbar1_ButtonClick(ByVal Button As MSComctlLib.Button)
Select Case Button

Case "Undo"
    Backup (1)
    UpdateGlobalValues (1)

Case "Cancel"
    Backup (1)
    Unload Me
      
Case "OK"
    If Not UpdateGlobalValues(2) Then Exit Sub
    If CheckValues Then
        Icalc = 0
        Unload Me
        End If

Case "Help"
    ShowHelp (HelpContextID)

Case "Clear"

If MsgBox("Clear All Values?", vbYesNo) = vbYes Then UpdateGlobalValues (3)

End Select

End Sub
Private Function CheckValues() As Boolean
If P(1) <= 0 Then
        MsgBox "Averaging period must be > 0", vbExclamation
        CheckValues = False
    Else
        CheckValues = True
    End If
End Function
Private Sub Form_Load()
    SetToolTips
    Backup (0)
    UpdateGlobalValues (1)
    glAvrPeriod = P(1) ' hold original value
    
End Sub

Private Function UpdateGlobalValues(io) As Boolean

'io=1 copy source values to temporary array
'io=2 copy from temporary array to original
'io=3 copy from text boxes to temporary array
'io=4 copy from temporary array to text boxes
'io=5 clear temporary array to default values
UpdateGlobalValues = False
Select Case io

Case 1   'fill temporary array
    
    txtGlobal(0) = P(1) 'Averaging Period (yrs)
    txtGlobal(1) = P(2) 'precip (m) PER averaging period
    txtGlobal(2) = Cp(2)
    txtGlobal(3) = P(3)  'evap (m)  PER averaging period
    txtGlobal(4) = Cp(3)
    txtGlobal(5) = P(4)  'storage increase (m) per averaging period
    txtGlobal(6) = Cp(4)
    txtGlobal(7) = Atm(2)   'tp
    txtGlobal(8) = CvAtm(2)
    txtGlobal(9) = Atm(4)   'orthop
    txtGlobal(10) = CvAtm(4)
    txtGlobal(11) = Atm(3)   'tn
    txtGlobal(12) = CvAtm(3)
    txtGlobal(13) = Atm(5)   'inorgn
    txtGlobal(14) = CvAtm(5)
    txtGlobal(15) = Atm(1)   'cl
    txtGlobal(16) = CvAtm(1)
    txtGlobal(17) = Title
    txt = ""
    For i = 1 To 10
        txt = txt & Note(i) & vbCrLf
        Next i
        txtGlobal(18) = txt
  
    
Case 2    'copy from temporary array back to original values
    'check if averaging period has changed & warn
    P(1) = txtGlobal(0) 'averaging period
    If Not (P(1) = glAvrPeriod) Then
    If MsgBox("Remember that Precipitation, Evaporation, and Storage Are PER AVERAGING PERIOD" _
    , vbOKCancel, "Averaging Period Changed") = vbCancel Then Exit Function
      End If
    P(2) = txtGlobal(1) 'precip
    Cp(2) = txtGlobal(2)
    P(3) = txtGlobal(3) 'evap
    Cp(3) = txtGlobal(4)
    P(4) = txtGlobal(5) 'storage
    Cp(4) = txtGlobal(6)
    Atm(2) = txtGlobal(7) 'tp
    CvAtm(2) = txtGlobal(8)
    Atm(4) = txtGlobal(9) 'orthop
    CvAtm(4) = txtGlobal(10)
    Atm(3) = txtGlobal(11) 'tn
    CvAtm(3) = txtGlobal(12)
    Atm(5) = txtGlobal(13)  'inorgn
    CvAtm(5) = txtGlobal(14)
    Atm(1) = txtGlobal(15) 'cl
    CvAtm(1) = txtGlobal(16)
    Title = txtGlobal(17)
    'notes
        i = 1
        Note(i) = ""
     For j = 1 To Len(txtGlobal(18))
        s = Mid(txtGlobal(18), j, 1)
        If s = vbCrLf Then
            i = i + 1
            If i > 10 Then Exit For
            Note(i) = ""
           Else
           Note(i) = Note(i) + s
           End If
        Next j
    For j = i + 1 To 10
        Note(j) = ""
        Next j
    

Case 3    'set defaults
    txtGlobal(18) = ""
    txtGlobal(17) = ""
    For j = 1 To 16
        txtGlobal(j) = 0
        Next j
    txtGlobal(0) = 1
    Changed = True

Case default

End Select
UpdateGlobalValues = True
End Function
Private Sub Form_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
    lblDefinitions.Caption = ""
End Sub


Private Sub SetToolTips()
             txtGlobal(0).ToolTipText = "Length of Averaging Period for Mass Balance (years)"
             txtGlobal(1).ToolTipText = "Total Precipitation (m)"
             txtGlobal(2).ToolTipText = "CV of Total Preciptation"
             txtGlobal(3).ToolTipText = "Evaporation(m)"
             txtGlobal(4).ToolTipText = "CV of Evaporation"
             txtGlobal(5).ToolTipText = "Increase in Water Surface Elevation (m)"
             txtGlobal(6).ToolTipText = "CV of Storage Increase"
             txtGlobal(7).ToolTipText = "Atmospheric Load of Total P (mg/m2-yr)"
             txtGlobal(8).ToolTipText = "CV of Atmospheric Total P Load"
             txtGlobal(9).ToolTipText = "Atmospheric Load of Ortho P (mg/m2-yr)"
             txtGlobal(10).ToolTipText = "CV of Atmospheric Ortho P Load"
             txtGlobal(11).ToolTipText = "Atmospheric Load of Total N (mg/m2-yr)"
             txtGlobal(12).ToolTipText = "CV of Atmospheric Total N Load"
             txtGlobal(13).ToolTipText = "Atmospheric Load of Inorganic N (mg/m2-yr)"
             txtGlobal(14).ToolTipText = "CV of Atmospheric Inorganic N Load"
             txtGlobal(15).ToolTipText = "Atmospheric Load of Conservative Substance (mg/m2-yr)"
             txtGlobal(16).ToolTipText = "CV of Atmospheric Conservative Substance Load"
             txtGlobal(17).ToolTipText = "Title for Labeling Output"
             txtGlobal(18).ToolTipText = "User Notes"
            End Sub

Private Sub txtglobal_Change(index As Integer)
    If index = 0 Then
    'MsgBox ("Remember that Precipitation, Evaporation, and Storage Are PER AVERAGING PERIOD")
    End If
    If index = 5 Then
        If Not VerifyNumber(txtGlobal(index)) Then txtGlobal(index) = ""
    ElseIf index < 17 Then
        If Not VerifyPositive(txtGlobal(index)) Then txtGlobal(index) = ""
        End If
    Changed = True
End Sub
Private Sub txtglobal_MouseMove(index As Integer, Button As Integer, Shift As Integer, x As Single, y As Single)
    lblDefinitions.Caption = txtGlobal(index).ToolTipText
End Sub
'Private Sub txtGlobal_Validate(Index As Integer, Cancel As Boolean)
'    If txtGlobal(Index) = "" Then Cancel = True
'End Sub

Private Sub txtGlobal_lostfocus(index As Integer)
    If index < 17 And txtGlobal(index) = "" Then txtGlobal(index) = 0
End Sub

