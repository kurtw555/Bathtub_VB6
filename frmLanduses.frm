VERSION 5.00
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.Form frmLandUse 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Edit NonPoint Source Export Coefficients"
   ClientHeight    =   6660
   ClientLeft      =   45
   ClientTop       =   330
   ClientWidth     =   6135
   HelpContextID   =   6
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   6660
   ScaleWidth      =   6135
   ShowInTaskbar   =   0   'False
   StartUpPosition =   3  'Windows Default
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   12
      Left            =   4800
      TabIndex        =   13
      Text            =   "Text1"
      Top             =   6000
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   11
      Left            =   3240
      TabIndex        =   12
      Text            =   "Text1"
      Top             =   6000
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   10
      Left            =   4800
      TabIndex        =   11
      Text            =   "Text1"
      Top             =   5400
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   9
      Left            =   3240
      TabIndex        =   10
      Text            =   "Text1"
      Top             =   5400
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   8
      Left            =   4800
      TabIndex        =   9
      Text            =   "Text1"
      Top             =   4800
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   7
      Left            =   3240
      TabIndex        =   8
      Text            =   "Text1"
      Top             =   4800
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   6
      Left            =   4800
      TabIndex        =   7
      Text            =   "Text1"
      Top             =   4200
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   5
      Left            =   3240
      TabIndex        =   6
      Text            =   "Text1"
      Top             =   4200
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   4800
      TabIndex        =   5
      Text            =   "Text1"
      Top             =   3600
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   3240
      TabIndex        =   4
      Text            =   "Text1"
      Top             =   3600
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   4800
      TabIndex        =   3
      Text            =   "Text1"
      Top             =   3000
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Alignment       =   2  'Center
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   3240
      TabIndex        =   2
      Text            =   "Text1"
      Top             =   3000
      Width           =   1335
   End
   Begin VB.TextBox Text1 
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   3360
      TabIndex        =   1
      Text            =   "Text1"
      Top             =   2040
      Width           =   2175
   End
   Begin VB.ComboBox Combo1 
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   360
      Left            =   240
      Style           =   2  'Dropdown List
      TabIndex        =   0
      ToolTipText     =   "Select Land Use to be Edited"
      Top             =   840
      Width           =   2415
   End
   Begin MSComctlLib.Toolbar Toolbar1 
      Align           =   1  'Align Top
      Height          =   630
      Left            =   0
      TabIndex        =   24
      Top             =   0
      Width           =   6135
      _ExtentX        =   10821
      _ExtentY        =   1111
      ButtonWidth     =   1032
      ButtonHeight    =   953
      Appearance      =   1
      HelpContextID   =   6
      _Version        =   393216
      BeginProperty Buttons {66833FE8-8583-11D1-B16A-00C0F0283628} 
         NumButtons      =   5
         BeginProperty Button1 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Caption         =   "Clear"
            Key             =   "bthClear"
            Object.ToolTipText     =   "Clear values for current land use"
         EndProperty
         BeginProperty Button2 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Caption         =   "Undo"
            Key             =   "btnUndo"
            Object.ToolTipText     =   "Restore initial values for all land uses"
         EndProperty
         BeginProperty Button3 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Caption         =   "Help"
            Key             =   "btnHelp"
            Object.ToolTipText     =   "Get Help"
         EndProperty
         BeginProperty Button4 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Caption         =   "Cancel"
            Key             =   "btnCancel"
            Object.ToolTipText     =   "Ignore edits & return to program menu"
         EndProperty
         BeginProperty Button5 {66833FEA-8583-11D1-B16A-00C0F0283628} 
            Caption         =   "OK"
            Key             =   "btnOK"
            Object.ToolTipText     =   "Save edits & return to program menu"
         EndProperty
      EndProperty
      BorderStyle     =   1
   End
   Begin VB.Label lblDefinitions 
      Alignment       =   2  'Center
      Caption         =   "Label2"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H8000000D&
      Height          =   255
      Left            =   840
      TabIndex        =   23
      Top             =   1440
      Width           =   4815
   End
   Begin VB.Label Label1 
      Alignment       =   2  'Center
      Caption         =   "CV"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   7
      Left            =   4800
      TabIndex        =   22
      Top             =   2520
      Width           =   855
   End
   Begin VB.Label Label1 
      Alignment       =   2  'Center
      Caption         =   "Mean"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   -1  'True
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   3360
      TabIndex        =   21
      Top             =   2520
      Width           =   855
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Caption         =   "Landuse Category Name:"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   6
      Left            =   240
      TabIndex        =   20
      Top             =   2040
      Width           =   2655
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Caption         =   "Conservative Subst. Conc (-):"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   5
      Left            =   0
      TabIndex        =   19
      Top             =   6000
      Width           =   2895
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Caption         =   "Inorganic N Conc (mg/m3):"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   4
      Left            =   360
      TabIndex        =   18
      Top             =   5400
      Width           =   2535
   End
   Begin VB.Label frmLandUses 
      Alignment       =   1  'Right Justify
      Caption         =   "Total N Conc (mg/m3):"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   3
      Left            =   720
      TabIndex        =   17
      Top             =   4800
      Width           =   2175
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Caption         =   "Ortho P Conc (mg/m3):"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   2
      Left            =   720
      TabIndex        =   16
      Top             =   4200
      Width           =   2175
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Caption         =   "Total P Conc (mg/m3):"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   1
      Left            =   720
      TabIndex        =   15
      Top             =   3600
      Width           =   2175
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Caption         =   "Runoff (m/yr):"
      BeginProperty Font 
         Name            =   "Microsoft Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Index           =   0
      Left            =   720
      TabIndex        =   14
      Top             =   3000
      Width           =   2175
   End
End
Attribute VB_Name = "frmLandUse"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Const nboX As Integer = 12
Private Changed As Boolean
Private jusE
Private Sub Toolbar1_ButtonClick(ByVal Button As MSComctlLib.Button)

Select Case Button

Case "Undo"
'restore original values for current coef
'    If Changed Then
'    If MsgBox("Restore All Input Values to Previously Saved Values ?", vbYesNo) = vbYes Then
'        UpdateLandUseValues (1)
'        End If
'        End If
    Backup (1)
    jusE = 1
    UpdateCombo1
    UpdateLandUseValues (1)

Case "OK"
  'If Changed Then
 '       If MsgBox("Save Edits?", vbYesNo) = vbYes Then UpdateLandUseValues (2)
 '       End If
    UpdateLandUseValues (2)
    Icalc = 0
    Unload Me
      
Case "Cancel"
    Backup (1)
    Unload Me
    
Case "Help"
      ShowHelp (HelpContextID)

Case "Clear"

If MsgBox("Clear all inputs for current land use?", vbYesNo) = vbYes Then
            UpdateLandUseValues (3)
            UpdateLandUseValues (2)
            End If
End Select

End Sub

Private Sub Form_Load()
    jusE = 1
    Backup (0)
    UpdateCombo1
    SetToolTips
    UpdateLandUseValues (1)
End Sub
 
Private Sub Combo1_click()
'load new LandUse
    j = Combo1.ListIndex + 1
    If j <> jusE Then
    '    If Changed Then
    '        If MsgBox("Save Edits for LandUse " & jusE & LandUseName(jusE) & " ?", vbYesNo) Then UpdateLandUseValues (2)
   '         End If
    UpdateLandUseValues (2)
    jusE = j
    Combo1.ListIndex = jusE - 1
    UpdateLandUseValues (1)
    End If
End Sub

Sub UpdateCombo1()
    With Combo1
    .Clear
    For i = 1 To NCAT
        .AddItem Format(i, "00") & " " & LandUseName(i)
        Next i
    .ListIndex = jusE - 1
    End With
    End Sub

Sub UpdateLandUseValues(io)
'io=1 copy source values to temporary array
'io=2 copy from temporary array to original
'io=3 clear temporary array to default values

Select Case io

Case 1   'fill temporary array
   
    Text1(0) = LandUseName(jusE)  'LandUse label
    Text1(1) = Ur(jusE)     'unit runoff
    Text1(2) = CvUr(jusE)     'unit runoff
    Text1(3) = Uc(jusE, 2)   'tp
    Text1(4) = CvUc(jusE, 2)
    Text1(5) = Uc(jusE, 4)   'srp
    Text1(6) = CvUc(jusE, 4)
    Text1(7) = Uc(jusE, 3)   'tn
    Text1(8) = CvUc(jusE, 3)
    Text1(9) = Uc(jusE, 5)   'inorgn
    Text1(10) = CvUc(jusE, 5)
    Text1(11) = Uc(jusE, 1)   'cons
    Text1(12) = CvUc(jusE, 1)
    Changed = False

Case 2    'copy from temporary array back to original values

    Combo1.List(jusE - 1) = Format(jusE - 1, "00") & " " & Text1(0)
    LandUseName(jusE) = Text1(0) 'LandUse label
    Ur(jusE) = Text1(1)   'unit runoff
    CvUr(jusE) = Text1(2)   'unit runoff
    Uc(jusE, 2) = Text1(3) 'tp
    CvUc(jusE, 2) = Text1(4)
    Uc(jusE, 4) = Text1(5) 'srp
    CvUc(jusE, 4) = Text1(6)
    Uc(jusE, 3) = Text1(7) 'tn
    CvUc(jusE, 3) = Text1(8)
    Uc(jusE, 5) = Text1(9) 'inorgn
    CvUc(jusE, 5) = Text1(10)
    Uc(jusE, 1) = Text1(11) 'cons
    CvUc(jusE, 1) = Text1(12)
    Changed = False
    
Case 3    'set defaults
    Text1(0) = "Landuse " & jusE
    For j = 1 To nboX
        Text1(j) = 0
        Next j

Case default

End Select

End Sub
Private Sub Form_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
    lblDefinitions.Caption = ""
End Sub

Private Sub SetToolTips()
             Text1(0).ToolTipText = "Land Use Name"
             Text1(1).ToolTipText = "Unit Area Runoff (m/yr)"
             Text1(2).ToolTipText = "CV of Unit Area Runoff (m/yr)"
             Text1(3).ToolTipText = "Runoff Total P Conc (ppb)"
             Text1(4).ToolTipText = "CV of Runoff Total P Conc (ppb)"
             Text1(5).ToolTipText = "Runoff Ortho P Conc (ppb)"
             Text1(6).ToolTipText = "CV of Runoff Ortho P Conc (ppb)"
             Text1(7).ToolTipText = "Runoff Total N Conc (ppb)"
             Text1(8).ToolTipText = "CV of Runoff Total N Conc (ppb)"
             Text1(9).ToolTipText = "Runoff Inorganic N Conc (ppb)"
             Text1(10).ToolTipText = "CV of Runoff Inorganic N Conc (ppb)"
             Text1(11).ToolTipText = "Runoff Conservative Substance Conc (ppb)"
             Text1(12).ToolTipText = "CV of Runoff Conservative Substance Conc (ppb)"
            End Sub

Private Sub text1_Change(index As Integer)
If index <> 0 Then
    If Not VerifyPositive(Text1(index)) Then Text1(index) = ""
    End If
End Sub

Private Sub text1_lostfocus(index As Integer)
If index <> 0 Then
    If Text1(index) = "" Then Text1(index) = 0
    End If
End Sub


Private Sub text1_MouseMove(index As Integer, Button As Integer, Shift As Integer, x As Single, y As Single)
    lblDefinitions.Caption = Text1(index).ToolTipText
End Sub

Private Sub Toolbar1_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
    'MsgBox "button number : " & Button
    'lblDefinitions.Caption = Toolbar1.Buttons(Button).ToolTipText
End Sub
